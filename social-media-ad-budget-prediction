{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "30100eaa",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-12-03T00:49:47.326863Z",
     "iopub.status.busy": "2025-12-03T00:49:47.326391Z",
     "iopub.status.idle": "2025-12-03T00:49:52.885600Z",
     "shell.execute_reply": "2025-12-03T00:49:52.884259Z"
    },
    "papermill": {
     "duration": 5.564885,
     "end_time": "2025-12-03T00:49:52.887511",
     "exception": false,
     "start_time": "2025-12-03T00:49:47.322626",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Files in dataset folder:\n",
      "['Social_Media_Advertising.csv']\n",
      "\n",
      "Reading file: /kaggle/input/social-media-advertising-dataset/Social_Media_Advertising.csv\n",
      "\n",
      "Data preview:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Campaign_ID</th>\n",
       "      <th>Target_Audience</th>\n",
       "      <th>Campaign_Goal</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Channel_Used</th>\n",
       "      <th>Conversion_Rate</th>\n",
       "      <th>Acquisition_Cost</th>\n",
       "      <th>ROI</th>\n",
       "      <th>Location</th>\n",
       "      <th>Language</th>\n",
       "      <th>Clicks</th>\n",
       "      <th>Impressions</th>\n",
       "      <th>Engagement_Score</th>\n",
       "      <th>Customer_Segment</th>\n",
       "      <th>Date</th>\n",
       "      <th>Company</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>529013</td>\n",
       "      <td>Men 35-44</td>\n",
       "      <td>Product Launch</td>\n",
       "      <td>15 Days</td>\n",
       "      <td>Instagram</td>\n",
       "      <td>0.15</td>\n",
       "      <td>$500.00</td>\n",
       "      <td>5.790000</td>\n",
       "      <td>Las Vegas</td>\n",
       "      <td>Spanish</td>\n",
       "      <td>500</td>\n",
       "      <td>3000</td>\n",
       "      <td>7</td>\n",
       "      <td>Health</td>\n",
       "      <td>2022-02-25</td>\n",
       "      <td>Aura Align</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>275352</td>\n",
       "      <td>Women 45-60</td>\n",
       "      <td>Market Expansion</td>\n",
       "      <td>15 Days</td>\n",
       "      <td>Facebook</td>\n",
       "      <td>0.01</td>\n",
       "      <td>$500.00</td>\n",
       "      <td>7.210000</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>French</td>\n",
       "      <td>500</td>\n",
       "      <td>3000</td>\n",
       "      <td>5</td>\n",
       "      <td>Home</td>\n",
       "      <td>2022-05-12</td>\n",
       "      <td>Hearth Harmony</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>692322</td>\n",
       "      <td>Men 45-60</td>\n",
       "      <td>Product Launch</td>\n",
       "      <td>15 Days</td>\n",
       "      <td>Instagram</td>\n",
       "      <td>0.08</td>\n",
       "      <td>$500.00</td>\n",
       "      <td>0.430000</td>\n",
       "      <td>Austin</td>\n",
       "      <td>Spanish</td>\n",
       "      <td>500</td>\n",
       "      <td>3000</td>\n",
       "      <td>9</td>\n",
       "      <td>Technology</td>\n",
       "      <td>2022-06-19</td>\n",
       "      <td>Cyber Circuit</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>675757</td>\n",
       "      <td>Men 25-34</td>\n",
       "      <td>Increase Sales</td>\n",
       "      <td>15 Days</td>\n",
       "      <td>Pinterest</td>\n",
       "      <td>0.03</td>\n",
       "      <td>$500.00</td>\n",
       "      <td>0.909824</td>\n",
       "      <td>Miami</td>\n",
       "      <td>Spanish</td>\n",
       "      <td>293</td>\n",
       "      <td>1937</td>\n",
       "      <td>1</td>\n",
       "      <td>Health</td>\n",
       "      <td>2022-09-08</td>\n",
       "      <td>Well Wish</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>535900</td>\n",
       "      <td>Men 45-60</td>\n",
       "      <td>Market Expansion</td>\n",
       "      <td>15 Days</td>\n",
       "      <td>Pinterest</td>\n",
       "      <td>0.13</td>\n",
       "      <td>$500.00</td>\n",
       "      <td>1.422828</td>\n",
       "      <td>Austin</td>\n",
       "      <td>French</td>\n",
       "      <td>293</td>\n",
       "      <td>1937</td>\n",
       "      <td>1</td>\n",
       "      <td>Home</td>\n",
       "      <td>2022-08-24</td>\n",
       "      <td>Hearth Harmony</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Campaign_ID Target_Audience     Campaign_Goal Duration Channel_Used  \\\n",
       "0       529013       Men 35-44    Product Launch  15 Days    Instagram   \n",
       "1       275352     Women 45-60  Market Expansion  15 Days     Facebook   \n",
       "2       692322       Men 45-60    Product Launch  15 Days    Instagram   \n",
       "3       675757       Men 25-34    Increase Sales  15 Days    Pinterest   \n",
       "4       535900       Men 45-60  Market Expansion  15 Days    Pinterest   \n",
       "\n",
       "   Conversion_Rate Acquisition_Cost       ROI     Location Language  Clicks  \\\n",
       "0             0.15          $500.00  5.790000    Las Vegas  Spanish     500   \n",
       "1             0.01          $500.00  7.210000  Los Angeles   French     500   \n",
       "2             0.08          $500.00  0.430000       Austin  Spanish     500   \n",
       "3             0.03          $500.00  0.909824        Miami  Spanish     293   \n",
       "4             0.13          $500.00  1.422828       Austin   French     293   \n",
       "\n",
       "   Impressions  Engagement_Score Customer_Segment        Date         Company  \n",
       "0         3000                 7           Health  2022-02-25      Aura Align  \n",
       "1         3000                 5             Home  2022-05-12  Hearth Harmony  \n",
       "2         3000                 9       Technology  2022-06-19   Cyber Circuit  \n",
       "3         1937                 1           Health  2022-09-08       Well Wish  \n",
       "4         1937                 1             Home  2022-08-24  Hearth Harmony  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Data info:\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 300000 entries, 0 to 299999\n",
      "Data columns (total 16 columns):\n",
      " #   Column            Non-Null Count   Dtype  \n",
      "---  ------            --------------   -----  \n",
      " 0   Campaign_ID       300000 non-null  int64  \n",
      " 1   Target_Audience   300000 non-null  object \n",
      " 2   Campaign_Goal     300000 non-null  object \n",
      " 3   Duration          300000 non-null  object \n",
      " 4   Channel_Used      300000 non-null  object \n",
      " 5   Conversion_Rate   300000 non-null  float64\n",
      " 6   Acquisition_Cost  300000 non-null  object \n",
      " 7   ROI               300000 non-null  float64\n",
      " 8   Location          300000 non-null  object \n",
      " 9   Language          300000 non-null  object \n",
      " 10  Clicks            300000 non-null  int64  \n",
      " 11  Impressions       300000 non-null  int64  \n",
      " 12  Engagement_Score  300000 non-null  int64  \n",
      " 13  Customer_Segment  300000 non-null  object \n",
      " 14  Date              300000 non-null  object \n",
      " 15  Company           300000 non-null  object \n",
      "dtypes: float64(2), int64(4), object(10)\n",
      "memory usage: 36.6+ MB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# ===================== Cell 1: Imports & Load Data =====================\n",
    "import os\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score\n",
    "\n",
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.compose import ColumnTransformer\n",
    "from sklearn.impute import SimpleImputer\n",
    "from sklearn.preprocessing import OneHotEncoder\n",
    "\n",
    "import xgboost as xgb\n",
    "import joblib\n",
    "\n",
    "# Kaggle data directory\n",
    "DATA_DIR = \"/kaggle/input/social-media-advertising-dataset\"\n",
    "\n",
    "print(\"Files in dataset folder:\")\n",
    "print(os.listdir(DATA_DIR))\n",
    "\n",
    "# Automatically pick the first CSV file\n",
    "csv_files = [f for f in os.listdir(DATA_DIR) if f.endswith(\".csv\")]\n",
    "if len(csv_files) == 0:\n",
    "    raise FileNotFoundError(\"No CSV files found in the dataset folder.\")\n",
    "\n",
    "CSV_PATH = os.path.join(DATA_DIR, csv_files[0])\n",
    "print(\"\\nReading file:\", CSV_PATH)\n",
    "\n",
    "df = pd.read_csv(CSV_PATH)\n",
    "\n",
    "print(\"\\nData preview:\")\n",
    "display(df.head())\n",
    "\n",
    "print(\"\\nData info:\")\n",
    "print(df.info())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "0b5ddd74",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-03T00:49:52.893941Z",
     "iopub.status.busy": "2025-12-03T00:49:52.893652Z",
     "iopub.status.idle": "2025-12-03T00:49:53.080972Z",
     "shell.execute_reply": "2025-12-03T00:49:53.079683Z"
    },
    "papermill": {
     "duration": 0.192349,
     "end_time": "2025-12-03T00:49:53.082505",
     "exception": false,
     "start_time": "2025-12-03T00:49:52.890156",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape of X (features): (300000, 15)\n",
      "Shape of y (target): (300000,)\n",
      "\n",
      "Numeric features: ['Campaign_ID', 'Conversion_Rate', 'ROI', 'Clicks', 'Impressions', 'Engagement_Score']\n",
      "Categorical features: ['Target_Audience', 'Campaign_Goal', 'Duration', 'Channel_Used', 'Location', 'Language', 'Customer_Segment', 'Date', 'Company']\n",
      "\n",
      "Train shape: (240000, 15)  | Valid shape: (60000, 15)\n"
     ]
    }
   ],
   "source": [
    "# ===================== Cell 2: Define Target & Split =====================\n",
    "\n",
    "# ðŸ‘‰ CHANGE THIS if your budget column has a different name\n",
    "# Examples: \"Budget\", \"Ad_Spend\", \"Total_Spend\", etc.\n",
    "TARGET_COL = \"Acquisition_Cost\"   # <-- edit here after checking df.columns\n",
    "\n",
    "if TARGET_COL not in df.columns:\n",
    "    print(\"Available columns:\", df.columns.tolist())\n",
    "    raise ValueError(f\"'{TARGET_COL}' not found in columns. Change TARGET_COL to the correct budget column name.\")\n",
    "\n",
    "# Drop rows where target is missing\n",
    "df = df.dropna(subset=[TARGET_COL])\n",
    "\n",
    "X = df.drop(columns=[TARGET_COL])\n",
    "y = df[TARGET_COL]\n",
    "\n",
    "print(\"Shape of X (features):\", X.shape)\n",
    "print(\"Shape of y (target):\", y.shape)\n",
    "\n",
    "# Identify numeric and categorical columns automatically\n",
    "num_features = X.select_dtypes(include=[\"int64\", \"float64\", \"int32\", \"float32\"]).columns.tolist()\n",
    "cat_features = X.select_dtypes(include=[\"object\", \"category\", \"bool\"]).columns.tolist()\n",
    "\n",
    "print(\"\\nNumeric features:\", num_features)\n",
    "print(\"Categorical features:\", cat_features)\n",
    "\n",
    "# Trainâ€“validation split\n",
    "X_train, X_valid, y_train, y_valid = train_test_split(\n",
    "    X, y, test_size=0.2, random_state=42\n",
    ")\n",
    "\n",
    "print(\"\\nTrain shape:\", X_train.shape, \" | Valid shape:\", X_valid.shape)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "15927716",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-03T00:49:53.088354Z",
     "iopub.status.busy": "2025-12-03T00:49:53.088088Z",
     "iopub.status.idle": "2025-12-03T00:49:58.384120Z",
     "shell.execute_reply": "2025-12-03T00:49:58.382981Z"
    },
    "papermill": {
     "duration": 5.301199,
     "end_time": "2025-12-03T00:49:58.386034",
     "exception": false,
     "start_time": "2025-12-03T00:49:53.084835",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fitting XGBoost regression model...\n",
      "Done.\n"
     ]
    }
   ],
   "source": [
    "# ===================== Cell 3: Build Preprocessor + XGBoost Model (FIXED) =====================\n",
    "\n",
    "# Make sure target (budget/spend) is numeric (remove $ and , then convert)\n",
    "def clean_currency(s):\n",
    "    return (\n",
    "        s.astype(str)\n",
    "         .str.replace(r'[\\$,]', '', regex=True)\n",
    "         .astype(float)\n",
    "    )\n",
    "\n",
    "y_train = clean_currency(y_train)\n",
    "y_valid = clean_currency(y_valid)\n",
    "\n",
    "# Pipelines for numeric and categorical features\n",
    "numeric_transformer = Pipeline(steps=[\n",
    "    (\"imputer\", SimpleImputer(strategy=\"median\"))\n",
    "])\n",
    "\n",
    "categorical_transformer = Pipeline(steps=[\n",
    "    (\"imputer\", SimpleImputer(strategy=\"most_frequent\")),\n",
    "    (\"onehot\", OneHotEncoder(handle_unknown=\"ignore\"))\n",
    "])\n",
    "\n",
    "preprocessor = ColumnTransformer(\n",
    "    transformers=[\n",
    "        (\"num\", numeric_transformer, num_features),\n",
    "        (\"cat\", categorical_transformer, cat_features)\n",
    "    ]\n",
    ")\n",
    "\n",
    "# XGBoost Regressor\n",
    "xgb_reg = xgb.XGBRegressor(\n",
    "    n_estimators=300,\n",
    "    learning_rate=0.05,\n",
    "    max_depth=4,\n",
    "    subsample=0.9,\n",
    "    colsample_bytree=0.9,\n",
    "    random_state=42,\n",
    "    n_jobs=-1,\n",
    "    objective=\"reg:squarederror\"\n",
    ")\n",
    "\n",
    "# Full pipeline: preprocessing + model\n",
    "model = Pipeline(steps=[\n",
    "    (\"preprocessor\", preprocessor),\n",
    "    (\"xgb\", xgb_reg)\n",
    "])\n",
    "\n",
    "print(\"Fitting XGBoost regression model...\")\n",
    "model.fit(X_train, y_train)\n",
    "print(\"Done.\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "7806ad98",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-03T00:49:58.392958Z",
     "iopub.status.busy": "2025-12-03T00:49:58.392650Z",
     "iopub.status.idle": "2025-12-03T00:49:58.884536Z",
     "shell.execute_reply": "2025-12-03T00:49:58.883560Z"
    },
    "papermill": {
     "duration": 0.497165,
     "end_time": "2025-12-03T00:49:58.886028",
     "exception": false,
     "start_time": "2025-12-03T00:49:58.388863",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==== Evaluation Metrics (Validation Set) ====\n",
      "MAE  (Mean Absolute Error): 20.7443\n",
      "RMSE (Root Mean Squared Error): 28.1332\n",
      "RÂ²   (Coefficient of Determination): 1.0000\n",
      "\n",
      "Sample predictions (first 20 rows):\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Actual_Budget</th>\n",
       "      <th>Predicted_Budget</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>500.00</td>\n",
       "      <td>480.693329</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2977.30</td>\n",
       "      <td>2988.292480</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6064.53</td>\n",
       "      <td>6062.167969</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>15000.00</td>\n",
       "      <td>14996.583008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>8899.65</td>\n",
       "      <td>8923.853516</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1857.02</td>\n",
       "      <td>1846.828003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>12347.82</td>\n",
       "      <td>12330.561523</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>6681.21</td>\n",
       "      <td>6671.917480</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>3956.43</td>\n",
       "      <td>3947.145264</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>11047.80</td>\n",
       "      <td>11023.303711</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>7673.11</td>\n",
       "      <td>7648.786621</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>8032.81</td>\n",
       "      <td>8045.741699</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>5363.07</td>\n",
       "      <td>5358.101562</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>12193.26</td>\n",
       "      <td>12180.314453</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>9949.93</td>\n",
       "      <td>9971.965820</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>12061.15</td>\n",
       "      <td>12018.099609</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>13305.50</td>\n",
       "      <td>13317.869141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>10519.22</td>\n",
       "      <td>10496.795898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>15000.00</td>\n",
       "      <td>14976.085938</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>11188.50</td>\n",
       "      <td>11131.957031</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Actual_Budget  Predicted_Budget\n",
       "0          500.00        480.693329\n",
       "1         2977.30       2988.292480\n",
       "2         6064.53       6062.167969\n",
       "3        15000.00      14996.583008\n",
       "4         8899.65       8923.853516\n",
       "5         1857.02       1846.828003\n",
       "6        12347.82      12330.561523\n",
       "7         6681.21       6671.917480\n",
       "8         3956.43       3947.145264\n",
       "9        11047.80      11023.303711\n",
       "10        7673.11       7648.786621\n",
       "11        8032.81       8045.741699\n",
       "12        5363.07       5358.101562\n",
       "13       12193.26      12180.314453\n",
       "14        9949.93       9971.965820\n",
       "15       12061.15      12018.099609\n",
       "16       13305.50      13317.869141\n",
       "17       10519.22      10496.795898\n",
       "18       15000.00      14976.085938\n",
       "19       11188.50      11131.957031"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# ===================== Cell 4: Evaluate Model & Show Outputs =====================\n",
    "\n",
    "# Predict on validation set\n",
    "y_pred = model.predict(X_valid)\n",
    "\n",
    "mae = mean_absolute_error(y_valid, y_pred)\n",
    "rmse = mean_squared_error(y_valid, y_pred, squared=False)\n",
    "r2 = r2_score(y_valid, y_pred)\n",
    "\n",
    "print(\"==== Evaluation Metrics (Validation Set) ====\")\n",
    "print(f\"MAE  (Mean Absolute Error): {mae:.4f}\")\n",
    "print(f\"RMSE (Root Mean Squared Error): {rmse:.4f}\")\n",
    "print(f\"RÂ²   (Coefficient of Determination): {r2:.4f}\")\n",
    "\n",
    "# Show a small table for demo: actual vs predicted\n",
    "results_df = pd.DataFrame({\n",
    "    \"Actual_Budget\": y_valid.values[:20],\n",
    "    \"Predicted_Budget\": y_pred[:20]\n",
    "})\n",
    "print(\"\\nSample predictions (first 20 rows):\")\n",
    "display(results_df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "410be0af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-03T00:49:58.893281Z",
     "iopub.status.busy": "2025-12-03T00:49:58.892979Z",
     "iopub.status.idle": "2025-12-03T00:49:58.947493Z",
     "shell.execute_reply": "2025-12-03T00:49:58.945837Z"
    },
    "papermill": {
     "duration": 0.060462,
     "end_time": "2025-12-03T00:49:58.949169",
     "exception": false,
     "start_time": "2025-12-03T00:49:58.888707",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Saved model as xgb_ad_budget_model.pkl\n",
      "\n",
      "Demo single prediction:\n",
      "Input features:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Campaign_ID</th>\n",
       "      <th>Target_Audience</th>\n",
       "      <th>Campaign_Goal</th>\n",
       "      <th>Duration</th>\n",
       "      <th>Channel_Used</th>\n",
       "      <th>Conversion_Rate</th>\n",
       "      <th>ROI</th>\n",
       "      <th>Location</th>\n",
       "      <th>Language</th>\n",
       "      <th>Clicks</th>\n",
       "      <th>Impressions</th>\n",
       "      <th>Engagement_Score</th>\n",
       "      <th>Customer_Segment</th>\n",
       "      <th>Date</th>\n",
       "      <th>Company</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4941</th>\n",
       "      <td>284821</td>\n",
       "      <td>Men 45-60</td>\n",
       "      <td>Product Launch</td>\n",
       "      <td>15 Days</td>\n",
       "      <td>Twitter</td>\n",
       "      <td>0.04</td>\n",
       "      <td>6.79</td>\n",
       "      <td>Miami</td>\n",
       "      <td>English</td>\n",
       "      <td>1150</td>\n",
       "      <td>4926</td>\n",
       "      <td>1</td>\n",
       "      <td>Home</td>\n",
       "      <td>2022-07-18</td>\n",
       "      <td>Nest Neat</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Campaign_ID Target_Audience   Campaign_Goal Duration Channel_Used  \\\n",
       "4941       284821       Men 45-60  Product Launch  15 Days      Twitter   \n",
       "\n",
       "      Conversion_Rate   ROI Location Language  Clicks  Impressions  \\\n",
       "4941             0.04  6.79    Miami  English    1150         4926   \n",
       "\n",
       "      Engagement_Score Customer_Segment        Date    Company  \n",
       "4941                 1             Home  2022-07-18  Nest Neat  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "True budget:     500.0\n",
      "Predicted budget:480.6933\n"
     ]
    }
   ],
   "source": [
    "# ===================== Cell 5: Save Trained Model =====================\n",
    "\n",
    "# Save the whole pipeline (preprocessing + XGBoost model)\n",
    "joblib.dump(model, \"xgb_ad_budget_model.pkl\")\n",
    "print(\"Saved model as xgb_ad_budget_model.pkl\")\n",
    "\n",
    "# Optional: show how to load and predict on a single example\n",
    "loaded_model = joblib.load(\"xgb_ad_budget_model.pkl\")\n",
    "\n",
    "# Take one sample from validation set\n",
    "sample = X_valid.iloc[[0]]\n",
    "true_value = y_valid.iloc[0]\n",
    "pred_value = loaded_model.predict(sample)[0]\n",
    "\n",
    "print(\"\\nDemo single prediction:\")\n",
    "print(\"Input features:\")\n",
    "display(sample)\n",
    "print(f\"True budget:     {true_value}\")\n",
    "print(f\"Predicted budget:{pred_value:.4f}\")\n"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 4640366,
     "sourceId": 7901232,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31192,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 17.375462,
   "end_time": "2025-12-03T00:49:59.573566",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-12-03T00:49:42.198104",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
